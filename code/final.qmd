---
title: "final"
format: html
---

https://github.com/misssammwoods04/ENVS-193DS_spring-2025_final

```{r}
library(tidyverse)
library(janitor)
library(ggplot2)
library(here)
library(DHARMa)
library(ggeffects)
library(zoo)
```


# Problem 1

## a.

In part one, one co-worker used a linear regression test. In part two, they used and analysis of variance test (ANOVA). 

## b. 

The F distribution should be included to provide more context because it would help us determine significance, which helps us assess whether the observed differences are likely due to an actual relationship or random variation. since ANOVA only tells us that at least one group differs from the others, it would be important to conduct a post-hoc test (such as Tukey’s HSD) to identify which specific groups differ significantly from each other.

## c.

We found a strong correlation between annual total nitrogen laod nitrogen load (kg/year) and distance from the headwater (km) (Linear regression, r value, F distribution, p = 0.03, $\alpha$ = significance level)

Average nitrogen load (kg year⁻¹) differed significantly among nitrogen sources. Post-hoc testing confirmed significant differences between certain categories (One-way ANOVA, F distribution, Tukey HSD post-hoc test, p = 0.02, $\alpha$ = significance level)


# Problem 2

```{r}
sst <- read.csv("data/SBH_temperature_20241231.csv")
```


## a.

```{r}

sst_clean <- sst |> # data frame
  clean_names() |> # clean names
   mutate(month = factor(month.name[month], levels = month.name)) |>
  select(year, month, surf_temp_c) |> # only show these three columns
  filter(year == c(2018, 2019, 2020, 2021, 2022, 2023)) |> # only show these years
  group_by(year, month) |> # groups data by year and month
  summarise(mean_monthly_sst = mean(surf_temp_c, na.rm = TRUE),  .groups = "drop") |> # find mean sst of each month based on year
  mutate(mean_monthly_sst = zoo::na.approx(mean_monthly_sst, na.rm = FALSE)) # change month number to name (abbreviate)

```


```{r}
sst_clean |> 
  slice_sample(n = 5) # Display 5 random rows from sst_clean

str(sst_clean)# Show the structure of sst_clean
```

```{r}
ggplot(sst_clean, 
       aes(x = month, 
           y = mean_monthly_sst, 
           color = factor(year), 
           group = year)) +
  geom_point() +
  geom_line() +
  coord_cartesian(ylim = c(12, 20)) +   # Zoom y-axis to 14-20, keep all data
  scale_y_continuous(
    breaks = seq(14, 20, by = 2),
    labels = c (14, 16, 18, 20)
  ) +
  labs(x = "Month", 
       y = "Mean monthly sea surface temperature (\u00B0C)", 
       color = "Year") +
  theme_minimal() +
   theme(
    panel.grid.major = element_blank(),  # remove major grid lines
    panel.grid.minor = element_blank()   # remove minor grid lines
  )

```

# Problem 4

## a. 


My homework 3 visualization is a lot more detailed and creative and includes all my predictor variables while my initial visualization shows only one predictor variable. Also, my initial visualization is more straightforward because it is a simple graph while my final visualization is more complex. 
